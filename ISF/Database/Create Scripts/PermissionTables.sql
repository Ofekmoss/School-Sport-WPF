-- Deleting existing tables
-- ============================================
IF EXISTS(SELECT * FROM sysobjects WHERE name = 'SPORTSMAN_PERMISSIONS' AND type = 'U')
	DROP TABLE SPORTSMAN_PERMISSIONS
GO 

IF EXISTS(SELECT * FROM sysobjects WHERE name = 'SPORTSMAN_FORMS' AND type = 'U')
	DROP TABLE SPORTSMAN_FORMS
GO 

-- Creating tables
-- ============================================

-- =======    SPORTSMAN_FORMS TABLE   ======
CREATE TABLE SPORTSMAN_FORMS (
SPORTSMAN_FORM_ID		int				IDENTITY(1, 1),
FORM_CLASSNAME			nvarchar(200)	NOT NULL,
FORM_DESCRIPTION		nvarchar(255)	NOT NULL,
CONSTRAINT PK_SPORTSMAN_FORMS PRIMARY KEY(SPORTSMAN_FORM_ID),
CONSTRAINT UN_SPORTSMAN_FORM_CLASS UNIQUE(FORM_CLASSNAME)
)
GO 

-- =======    SPORTSMAN_PERMISSIONS TABLE   ======
CREATE TABLE SPORTSMAN_PERMISSIONS (
SPORTSMAN_PERMISSION_ID		int			IDENTITY(1, 1),
USER_ID						int			NOT NULL,
SPORTSMAN_FORM_ID			int,
PERMISSION_TYPE				int			NOT NULL,	--0 none,1 readonly,2 full.
CONSTRAINT PK_SPORTSMAN_PERMISSIONS PRIMARY KEY(SPORTSMAN_PERMISSION_ID),
CONSTRAINT UN_SPORTSMAN_PERMISSION UNIQUE(USER_ID, SPORTSMAN_FORM_ID),
CONSTRAINT FK_SPORTSMAN_PERMISSION_USER FOREIGN KEY (USER_ID)
	REFERENCES USERS(USER_ID),
CONSTRAINT FK_SPORTSMAN_PERMISSION_FORM FOREIGN KEY (SPORTSMAN_FORM_ID)
	REFERENCES SPORTSMAN_FORMS(SPORTSMAN_FORM_ID)
)
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.BugsTableView', 'עריכת הערות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.CalendarView', 'לוח שנה')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.ChampionshipsTableView', 'ניהול אליפויות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.ChargesTableView', 'ניהול חיובי בתי ספר')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.CitiesTableView', 'הגדרת יישובים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.CourtTypesTableView', 'ניהול סוגי מגרשים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.EquipmentTableView', 'ניהול ציוד התאחדות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.EquipmentTypesTableView', 'ניהול סוגי ציוד')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.FacilitiesTableView', 'ניהול מתקנים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.GameBoardsTableView', 'רשימת לוחות משחקים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.IsfPaymentsTableView', 'ניהול תשלומי התאחדות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.LogTableView', 'ניהול מעקב משתמשים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.MessagesTableView', 'הודעות מערכת')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.PaymentsTableView', 'ניהול תשלומי בית ספר')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.PhasePatternsTableView', 'רשימת תבניות שלבים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.PlayersTableView', 'רישום שחקנים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.ProductsTableView', 'עריכת תעריפי בסיס')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.RefereesTableView', 'ניהול שופטים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.RegionsTableView', 'עריכת מחוזות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.RuleSersTableView', 'רשימת תקנונים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.SchoolsTableView', 'ניהול בתי ספר')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.ScoreRangeTableView', 'ניהול ניקוד תוצאות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.SportFieldsTableView', 'עריכת מקצועות וסוגי מקצועות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.SportsTableView', 'עריכת ענפי ספורט')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.StandardChampionshipsTableView', 'ניהול אליפויות קבועות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.StudentsTableView', 'ניהול תלמידים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.TeamsTableView', 'רישום קבוצות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.UsersTableView', 'ניהול משתמשים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Producer.CompetitionChampionshipEditorView', 'ניהול אליפויות מסוג תחרות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Producer.GameBoardEditorView', 'עריכת לוחות משחקים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Producer.MatchChampionshipEditorView', 'ניהול אליפויות מסוג התמודדות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Producer.PhasePatternEditorView', 'עריכת תבניות שלבים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Producer.PlayerCardBuildForm', 'בניית כרטיסי שחקן')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Producer.RulesetEditorView', 'עריכת תקנונים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sport.UI.Dialogs.PrintForm', 'הדפסות כלליות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Forms.PermissionsForm', 'ניהול הרשאות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Details.StudentDetails', 'פרטי תלמידים')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Details.SchoolDetails', 'פרטי בית ספר')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('SportSite.Articles', 'עריכת כתבות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('SportSite.FlashNews', 'עריכת מבזקי חדשות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('SportSite.Pages', 'עריכת עמודי אינטרנט')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('Sportsman.Views.SeasonsTableView', 'ניהול עונות')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('SportSite.Polls', 'עריכת סקרים באתר')
GO

INSERT INTO SPORTSMAN_FORMS (FORM_CLASSNAME, FORM_DESCRIPTION)
VALUES ('SportSite.PermanentChamps', 'הגדרת ליגות קבועות')
GO


-- Creating tables
-- =============================================================

-- =======    PERMISSIONS TABLE   ======
CREATE TABLE PERMISSIONS (
PERMISSION_ID		nvarchar(50) NOT NULL,
PERMISSION_NAME		nvarchar(50) NOT NULL,
CONSTRAINT PK_PERMISSIONS PRIMARY KEY(PERMISSION_ID),
CONSTRAINT UN_PERMISSION_NAME UNIQUE (PERMISSION_NAME)
)
GO

-- =======    PERMISSION_TYPES TABLE   ======
CREATE TABLE PERMISSION_TYPES (
PERMISSION_TYPE_ID		int				NOT NULL,
PERMISSION_TYPE_NAME	nvarchar(50)	NOT NULL,
CONSTRAINT PK_PERMISSION_TYPES PRIMARY KEY(PERMISSION_TYPE_ID),
CONSTRAINT UN_PERMTYPE_NAME UNIQUE (PERMISSION_TYPE_NAME)
)
GO

-- =======    PERMISSION_PERMISSION_TYPES TABLE   ======
CREATE TABLE PERMISSION_PERMISSION_TYPES (
PERMISSION_ID			nvarchar(50)	NOT NULL,
PERMISSION_TYPE_ID		int				NOT NULL,
CONSTRAINT PK_PERMISSION_PERMISSION_TYPES PRIMARY KEY(PERMISSION_ID, PERMISSION_TYPE_ID),
CONSTRAINT FK_PERMPERMTYPE_PERM FOREIGN KEY (PERMISSION_ID)
	REFERENCES PERMISSIONS(PERMISSION_ID),
CONSTRAINT FK_PERMPERMTYPE_TYPE FOREIGN KEY (PERMISSION_TYPE_ID)
	REFERENCES PERMISSION_TYPES(PERMISSION_TYPE_ID)
)
GO

-- =======    USER_PERMISSIONS TABLE   ======
CREATE TABLE USER_PERMISSIONS (
USER_ID					int				NOT NULL,
PERMISSION_ID			nvarchar(50)	NOT NULL,
PERMISSION_TYPE_ID		int				NOT NULL,
CONSTRAINT PK_USER_PERMISSIONS PRIMARY KEY(USER_ID, PERMISSION_ID),
CONSTRAINT FK_USERPERM_PERM FOREIGN KEY (PERMISSION_ID, PERMISSION_TYPE_ID)
	REFERENCES PERMISSION_PERMISSION_TYPES(PERMISSION_ID, PERMISSION_TYPE_ID)
)
GO

-- =======    Permission Types   ======

INSERT INTO PERMISSION_TYPES(PERMISSION_TYPE_ID, PERMISSION_TYPE_NAME)
VALUES (1, 'קריאה מחוזית')
GO
INSERT INTO PERMISSION_TYPES(PERMISSION_TYPE_ID, PERMISSION_TYPE_NAME)
VALUES (2, 'קריאה בלבד')
GO
INSERT INTO PERMISSION_TYPES(PERMISSION_TYPE_ID, PERMISSION_TYPE_NAME)
VALUES (3, 'הרשאה מחוזית')
GO
INSERT INTO PERMISSION_TYPES(PERMISSION_TYPE_ID, PERMISSION_TYPE_NAME)
VALUES (4, 'מורשה')
GO

-- =======    Permissions   ======
INSERT INTO PERMISSIONS (PERMISSION_ID, PERMISSION_NAME)
VALUES ('region', 'מחוזות')
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('region', 2)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('region', 4)
GO

INSERT INTO PERMISSIONS (PERMISSION_ID, PERMISSION_NAME)
VALUES ('city', 'ישובים')
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('city', 1)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('city', 2)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('city', 3)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('city', 4)
GO

INSERT INTO PERMISSIONS (PERMISSION_ID, PERMISSION_NAME)
VALUES ('school', 'בתי ספר')
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('school', 1)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('school', 2)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('school', 3)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('school', 4)
GO

INSERT INTO PERMISSIONS (PERMISSION_ID, PERMISSION_NAME)
VALUES ('student', 'תלמידים')
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('student', 1)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('student', 2)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('student', 3)
GO
INSERT INTO PERMISSION_PERMISSION_TYPES (PERMISSION_ID, PERMISSION_TYPE_ID)
VALUES ('student', 4)
GO
